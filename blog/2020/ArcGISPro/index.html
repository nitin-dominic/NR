<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Object Detection in UAS-acquired Imagery Using ArcGIS Pro and Deep Learning | Nitin Rai</title> <meta name="author" content="Nitin Rai"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <link rel="stylesheet" href="/NR/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/NR/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/NR/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/NR/assets/img/nrf.svg?8772f57a87c9f666897fa2f1bbeb8954"> <link rel="stylesheet" href="/NR/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://nitin-dominic.github.io/NR/NR/blog/2020/ArcGISPro/"> <link rel="stylesheet" href="/NR/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/NR/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/NR/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/NR/"><span class="font-weight-bold">Nitin </span>Rai</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/NR/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/NR/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/NR/bookreads/">BookReads</a> </li> <li class="nav-item active"> <a class="nav-link" href="/NR/blog/">Blogs<span class="sr-only">(current)</span></a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Object Detection in UAS-acquired Imagery Using ArcGIS Pro and Deep Learning</h1> <p class="post-meta">August 20, 2020</p> <p class="post-tags"> <a href="/NR/blog/2020"> <i class="fa-solid fa-calendar fa-sm"></i> 2020 </a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>This write up/tutorial is for those who are currently involved with working on ArcGIS Pro and want to learn a bit about Deep Learning too. Although, Deep Learning can be executed and worked independently using Python and other common platforms, I’ll explain how can we integrate Deep Learning in ArcGIS Pro. If you already know how to do that, you may even choose to skip reading the write up. ArcGIS Pro has recently released 2.6 version which involves installing different newer version of Deep Learning packages within ArcGIS Pro. What needs to be noted down here is that there are several specific package versions of Deep Learning tools for ArcGIS Pro 2.5v and 2.6v. Pay attention while installing those packages because even if you miss out one package version you will end up in a lot of errors which is probably not desired to make you feel more frustrated. I have jotted down all the specific version for ArcGIS Pro 2.5v and 2.6v. Not only this but also, I have included few codes which you can write in python (just to automatize and save some time without much clicks!). Although you will find all these instructions on ESRI website (Deep Learning in ArcGIS Pro), you may have to browse through a lot of web pages back and forth to gather information from all sides. I have included all the details right here needed to integrate Deep Learning in ArcGIS Pro.</p> <div class="notice--danger"> <p>Before starting, please be mindful that the deep learning packages installed in this blog are outdated. Please check the latest versions within the software and install accordingly!</p> </div> <h3 id="1-installing-deep-learning-tools-in-arcgis-pro">1. Installing Deep Learning Tools in ArcGIS Pro</h3> <p><strong>a. ArcGIS Pro (2.5v)</strong></p> <ol> <li> <p>To begin, download Anaconda with a Python 3.6v (as I did in my case)</p> </li> <li> <p>Open Python Command Prompt and write these lines <em>(italicized)</em></p> </li> </ol> <p>In the place of deeplearning_arcgispro you can put any name you want. This creates an environment and clones everything from arcgispro-py3 which is already present in ArcGIS Pro folder when you initially installed it. This will also take few minutes to clone. After you have successfully cloned arcgispro-py3, you can see it by following this path, C:\Users&lt;username&gt;\AppData\Local\ESRI\conda\envs\deeplearning. Also please install all these in a newly created environment (folder).</p> <p><code class="language-plaintext highlighter-rouge">conda create –name deeplearning_arcgispro –clone arcgispro-py3</code></p> <p>now activate the created deeplearning_arcgispro envs</p> <p><code class="language-plaintext highlighter-rouge">activate deeplearning_arcgispro</code></p> <p>begin installing the packages (be specific with the versions here). Also, for those who doesn’t own a PC with Nvidia GPU and wish to run TensorFlow on a CPU instead of a GPU, you can add a package called <code class="language-plaintext highlighter-rouge">“tensorflow-mkl”</code> from the Python Package Manager in ArcGIS Pro itself.</p> <p><code class="language-plaintext highlighter-rouge">conda install tensorflow-gpu=1.14.0</code></p> <p><code class="language-plaintext highlighter-rouge">conda install keras-gpu = 2.2.4</code></p> <p><code class="language-plaintext highlighter-rouge">conda install scikit-image=0.15.0</code></p> <p><code class="language-plaintext highlighter-rouge">conda install Pillow = 6.1.0</code></p> <p><code class="language-plaintext highlighter-rouge">conda install fastai = 1.0.54</code></p> <p><code class="language-plaintext highlighter-rouge">conda install pytorch=1.1.0</code></p> <p><code class="language-plaintext highlighter-rouge">conda install libtiff=4.0.10 –no-deps</code></p> <p><code class="language-plaintext highlighter-rouge">proswap deeplearning_arcgispro</code></p> <p>Next time you’ll run ArcGIS Pro, click on Python in the opening window and click on Manage Environments. You’ll notice that the software has switched its active environment to your created environment, i.e., <code class="language-plaintext highlighter-rouge">deeplearning_arcgispro</code></p> <p><strong>b. ArcGIS Pro (2.6v)</strong></p> <p>Everything remains the same except the package versions. Follow everything except a few changes when typing the commands, so instead use,</p> <p>conda install tensorflow-gpu=2.1.0</p> <p>conda install keras-gpu = 2.3.1</p> <p>conda install scikit-image=0.17.2</p> <p>conda install pillow-simd=7.0.0</p> <p>conda install fastai=1.0.60</p> <p>conda install pytorch=1.4.0</p> <p>conda install libtiff=4.0.10</p> <p>conda install torchvision=0.5.0</p> <h3 id="2-creating-labels-and-exporting-data-for-deep-learning">2. Creating labels and exporting data for Deep Learning</h3> <p>This is the hardest and most time-consuming part of using Deep Learning in ArcGIS Pro. But if done sincerely and with patience can yield a good model. Now you’re going to manually create datasets for training and validation purpose. Always remember, the higher the datasets the better the model predicts or detects objects of interest.</p> <p>Begin with adding an imagery in ArcGIS Pro. Add an RGB imagery (can be a multispectral imagery with NIR &amp; RedEdge Bands too but I haven’t worked on it yet). After you have successfully added the imagery,</p> <ol> <li> <p>Click on Imagery tab and click on Classification Tools and finally click on Label Objects for Deep Learning.</p> </li> <li> <p>Once you click it, a new side window opens with Image Classification Specifications and new schema. Right click on new schema and click edit properties. Under edit properties add a class name (usually what you want the machine to detect for you). Once done, save it! You’ll see that the newly created Schema shows up on the screen within the side bar. Right click on that named schema and “Add a class”. This is basically creating images for different class types. Give it a name of the object you want to detect, give a value (usually 1) and color of your choice. Click on OK.</p> </li> <li> <p>Now you’ll see different set of tools above your created class, click on one of those according to your choice. It can be even hand-free for object delineation.</p> </li> <li> <p>After this step, edit objects (by hand) which you want your model to detect it for you. Carefully try to collect as much data as possible. Again, the datasets should be huge to build a good model.</p> </li> <li> <p>Within the Image Classification side bar, you’ll see the classes being created along with the pixel percent. After you have finished editing the objects, click on save (middle purple floppy) button. Under projects, click folders, click whatever name you have used to save the project and inside this give a feature class name.</p> </li> <li> <p>Once that is done, click on Export Training Data beside Labeled Objects in the same Image Classification sidebar,</p> </li> </ol> <p>Output Folder: Browse to the same Projects/Folders/<name of="" your="" project="">/ImageChips (create this folder).</name></p> <p>Image Format: JPEG (if you’re writing a code in Python, this is what the file type that the code will accept. I remember giving .tiff once and it threw an error stating that the parameters are not valid).</p> <p>Tile Size X: 256</p> <p>Tile Size Y: 256</p> <p>Stride X: 128</p> <p>Stride Y: 128</p> <p>Rotation Angle: 0 (you can change if you want)</p> <p>Meta Data Format: PASCAL Visual Object Classes (specifically for object detection)</p> <ol> <li>Run it! If you get an error here, there are probably 3 reasons,</li> </ol> <p>a. Either the versions of packages been installed are not appropriate, and the environment created, (this one is very very common issue),</p> <p>b. Problem with Output Folder specification (always use a newly made folder), or,</p> <p>c. Image Format.</p> <p>Alternatively use command line interface in Jupyter to Export your data</p> <p>https://pro.arcgis.com/en/pro-app/tool-reference/image-analyst/export-training-data-for-deelearning.htm</p> <h3 id="3-training-the-exported-data-to-build-a-model">3. Training the exported data to build a model</h3> <p>Now, ArcGIS Pro exports several files along with Images of your object of interest under ImageChips folder you made before. One of the files most important for performing Deep Learning is the .emd (ESRI Model Definition) file. This file is a passage that connects ArcGIS Pro and Deep Learning. You can even choose to edit this file and use TensorFlow, Keras according to you need and work. I’m planning in my next blog to write about how to edit these files and perform deep learning. Once you have the folder with you, you can choose to train your model either in the ArcGIS Pro Geoprocessing Tool (by typing Train Deep Learning Model) or Python. I did it in Python just to learn and visualize the interface during learning and prediction time. Below is my attached screenshot while training the data in Jupyter.</p> <p>Fig.2. Training data for object detection in ArcGIS Pro (v 2.5) If you’re using Geoprocessing tab (by clicking on Train Deep Learning Model tool, Image Analyst) in ArcGIS Pro to build a model, you can populate the required fields as follows,</p> <p>Input Training Data — You’ll add the ImageChips folder here which contains the images and .emd file as I described above</p> <p>Output Model — Make an empty folder and name it as per your choice</p> <p>Max Epochs — Default is 20 but I would recommend if you need a good accuracy go for a higher number, let’s say, 100. This has a direct connection with your GPU type you’re choosing. If it’s a powerful GPU, it won’t take much time.</p> <p>Model Parameters:</p> <p>Model Type: SSD (or RETINET for object detection). Don’t choose any other types as not all the models present are used for object detection.</p> <p>Batch Size: 2 (or maybe even 8, 16, 32 based on the system you’re using)</p> <p>If using SSD, specify grids [4, 2, 1], zooms [0.7, 1, 1.3] and ratios [[1, 1], [1, 0.5], [0.5, 1]] as default specifications.</p> <p>Advanced:</p> <p>Backbone Model — ResNet 34 (or ResNet 50)</p> <p>Leave Pre-trained model as of now if you’re doing it for the first time.</p> <p>Validation — Can be 10 or 20</p> <p>Leave everything as same and Run!</p> <p>Note: Now if you’re again getting an error, it is just because of those 3 reasons which I discussed earlier in this file. Try implementing it again. If you get all of this in one go, you’ll be happy. But if not, it’s going to make you feel a lot frustrated.</p> <h3 id="4-detecting-objects-using-the-trained-model">4. Detecting objects using the trained model</h3> <p>Once everything is done successfully, all you have to do is to open ArcGIS pro again and go to Analysis -&gt; Tools -&gt; Detect Objects Using Deep Learning. You can even implement a code (as I did) just to click run and let the algorithm export a file for you with detected objects and a shape file. In ArcGIS pro, you’ll see these information as you click on Detect Objects Using Deep Learning,</p> <p>Input Raster: Add your imagery here.</p> <p>Output Detected Objects: A new folder specifying where you save the shape file for the detected objects. This is really useful!</p> <p>Model Definition: Load your trained .emd file here.</p> <p>Click on Non-Maximum Suppression: This boils down a lot of detected rectangles (overlapping) to a few.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/NR/blog/2021/Nvidia/">Getting Started with Real-time Image Processing on Nvidia Jetson AGX Xavier</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/NR/blog/2020/HomoDeus/">The Quest to Become Homo Deus</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/NR/blog/2020/PrecAg/">Is Precision Agriculture Beyond the Pale Stream?</a> </li> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2025 Nitin Rai. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a>, hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>, and tweaked by Nitin Rai. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/NR/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/NR/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/NR/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/NR/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/NR/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/NR/assets/js/copy_code.js?07b8786bab9b4abe90d10e61f7d12ff7" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id="></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>